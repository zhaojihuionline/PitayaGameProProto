syntax = "proto3";

package gamesvr;

option go_package = "pitaya-game/protos/protobuf/pb/golang/gamesvr;gamesvrpb";
option csharp_namespace = "PitayaGame.GameSvr";

import "common/types/types.proto";
import "gamesvr/hero.proto";
import "gamesvr/spell.proto";

// ============================================================================
// 军队服务协议定义
// 微服务名称：gamesvr
// 包括：军队管理、部队编组
// ============================================================================

// ========== 数据结构 ==========

// 军队简要信息（列表用）
message ArmyBriefInfo {
  int64 army_id = 1;                // 军队ID
  string army_name = 2;             // 军队名称
  int32 hero_count = 3;             // 上阵英雄数量
  int64 created_at = 6;             // 创建时间
}

// 军队详细信息（详情用）
message ArmyDetailInfo {
  int64 army_id = 1;                // 军队ID
  string army_name = 2;             // 军队名称
  
  // 完整嵌套数据
  repeated HeroData deployed_heroes = 3;      // 上阵英雄列表（完整数据）
  
  int64 created_at = 6;             // 创建时间
  int64 updated_at = 7;             // 更新时间
}

// ========== 获取军队列表 ==========

// 获取军队列表请求
message GetArmyListRequest {
  // 无需参数，从 Session 获取 user_id
}

// 获取军队列表响应
message GetArmyListResponse {
  types.CommonResp resp = 1;
  repeated ArmyBriefInfo armies = 2;
}

// ========== 获取军队详情 ==========

// 获取军队详情请求
message GetArmyDetailRequest {
  int64 army_id = 1;
}

// 获取军队详情响应
message GetArmyDetailResponse {
  types.CommonResp resp = 1;
  ArmyDetailInfo army_detail = 2;
}

// ========== 创建军队 ==========

// 创建军队请求
message CreateArmyRequest {
  string army_name = 1;  // user_id 从 Session 获取
}

// 创建军队响应
message CreateArmyResponse {
  types.CommonResp resp = 1;
  int64 army_id = 2;  // 新创建的军队ID
}

// ========== 删除军队 ==========

// 删除军队请求
message DeleteArmyRequest {
  int64 army_id = 1;
}

// 删除军队响应
message DeleteArmyResponse {
  types.CommonResp resp = 1;
}

// ========== 重命名军队 ==========

// 重命名军队请求
message RenameArmyRequest {
  int64 army_id = 1;
  string new_name = 2;
}

// 重命名军队响应
message RenameArmyResponse {
  types.CommonResp resp = 1;
}

// ========== 部署英雄到军队 ==========

// 部署英雄到军队请求
message DeployHeroRequest {
  int64 army_id = 1;
  int64 hero_id = 2;
  int32 slot_index = 3;  // 上阵位置（可选，0表示自动分配）
}

// 部署英雄到军队响应
message DeployHeroResponse {
  types.CommonResp resp = 1;
}

// ========== 撤下英雄 ==========

// 撤下英雄请求
message UndeployHeroRequest {
  int64 army_id = 1;
  int64 hero_id = 2;
}

// 撤下英雄响应
message UndeployHeroResponse {
  types.CommonResp resp = 1;
}
